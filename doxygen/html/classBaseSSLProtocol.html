<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>crtmpserver: BaseSSLProtocol Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">crtmpserver</div>
   <div id="projectbrief">AmediaserverforAdobe®Flash®,Apple®iOSdevicesandblahblah.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>BaseSSLProtocol Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="BaseSSLProtocol" --><!-- doxytag: inherits="BaseProtocol" -->
<p><code>#include &lt;<a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BaseSSLProtocol:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classBaseSSLProtocol.png" usemap="#BaseSSLProtocol_map" alt=""/>
  <map id="BaseSSLProtocol_map" name="BaseSSLProtocol_map">
<area href="classBaseProtocol.html" alt="BaseProtocol" shape="rect" coords="73,0,210,24"/>
<area href="classInboundSSLProtocol.html" alt="InboundSSLProtocol" shape="rect" coords="0,112,137,136"/>
<area href="classOutboundSSLProtocol.html" alt="OutboundSSLProtocol" shape="rect" coords="147,112,284,136"/>
</map>
 </div></div>

<p><a href="classBaseSSLProtocol-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a557aefc85307a71c6b9644a4f591e403">BaseSSLProtocol</a> (uint64_t type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a607e108bd87246454cf78a55062bc666">~BaseSSLProtocol</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a44c2cf79a648a548477990b5c2763170">Initialize</a> (<a class="el" href="classVariant.html">Variant</a> &amp;parameters)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called to initialize internal resources specific to each protocol. This is called before adding the protocol to the stack.  <a href="#a44c2cf79a648a548477990b5c2763170"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#aad56fbe2f11c703de147dc195affdb3d">AllowFarProtocol</a> (uint64_t type)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return true if this protocol can be linked with a far protocol of type 'type'. Otherwise should return false.  <a href="#aad56fbe2f11c703de147dc195affdb3d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a027f1e45adbc701d82c87238b6434300">AllowNearProtocol</a> (uint64_t type)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return true if this protocol can be linked with a near protocol of type 'type'. Otherwise should return false.  <a href="#a027f1e45adbc701d82c87238b6434300"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a6d8017db40ae600cb76ca2543a4089fc">EnqueueForOutbound</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function can be called by anyone who wants to signal the transport layer that there is data ready to be sent. pExtraParameters usually is a pointer to an OutboundBuffer, but this depends on the protocol type.  <a href="#a6d8017db40ae600cb76ca2543a4089fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classIOBuffer.html">IOBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a544bdf17ea74226698d3523d4719fee8">GetOutputBuffer</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the output buffers.  <a href="#a544bdf17ea74226698d3523d4719fee8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classIOBuffer.html">IOBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a04941dd84058faa6325dadeea47312ef">GetInputBuffer</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the input buffers.  <a href="#a04941dd84058faa6325dadeea47312ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a714838df530226551ff8808a6104061c">SignalInputData</a> (int32_t recvAmount)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called by the framework when data is available for processing, directly from the network i/o layer.  <a href="#a714838df530226551ff8808a6104061c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a1440edc3c12e1d002ef2a0ac86594902">SignalInputData</a> (<a class="el" href="classIOBuffer.html">IOBuffer</a> &amp;buffer)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called by the framework when data is available for processing, from the underlaying protocol (NOT i/o layer)  <a href="#a1440edc3c12e1d002ef2a0ac86594902"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a831760013013d1ba62b4570dad7875d5">DoHandshake</a> ()=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a026c48144d22744aa3b91f01eb75da19">InitGlobalContext</a> (<a class="el" href="classVariant.html">Variant</a> &amp;parameters)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#afca7e0d2aaf118c186f3b2c8e4af8862">PerformIO</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#acadebf65ef31202b9edee0a4a2992571">GetSSLErrors</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">SSL_CTX *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a14fe4edf0aeca0ab3a171797c615aa9f">_pGlobalSSLContext</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">SSL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">_sslHandshakeCompleted</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">_pReadBuffer</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static map&lt; string, SSL_CTX * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#adf9da7f6c4000a46f7a73f9a73f374ea">_pGlobalContexts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#ad5706a8381dffb156cf89ea6d6cbed21">_libraryInitialized</a> = false</td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a9ddd63b95af3ae7177aa015c5dbfafb9">DumpBIO</a> (BIO *pBIO)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a74e20d241ea004e481c119ae43a26179">InitRandGenerator</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIOBuffer.html">IOBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">_inputBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIOBuffer.html">IOBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">_outputBuffer</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00026">26</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a557aefc85307a71c6b9644a4f591e403"></a><!-- doxytag: member="BaseSSLProtocol::BaseSSLProtocol" ref="a557aefc85307a71c6b9644a4f591e403" args="(uint64_t type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BaseSSLProtocol::BaseSSLProtocol </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00027">27</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">: <a class="code" href="classBaseProtocol.html#aa144d02565c587edc3f79b1db3040115">BaseProtocol</a>(type) {
        <a class="code" href="classBaseSSLProtocol.html#a14fe4edf0aeca0ab3a171797c615aa9f">_pGlobalSSLContext</a> = NULL;
        <a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a> = NULL;
        <a class="code" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">_sslHandshakeCompleted</a> = <span class="keyword">false</span>;
        <a class="code" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">_pReadBuffer</a> = <span class="keyword">new</span> uint8_t[<a class="code" href="basesslprotocol_8cpp.html#aa29055ce7ec81921b6b8e0446f739973">MAX_SSL_READ_BUFFER</a>];
}
</pre></div>
</div>
</div>
<a class="anchor" id="a607e108bd87246454cf78a55062bc666"></a><!-- doxytag: member="BaseSSLProtocol::~BaseSSLProtocol" ref="a607e108bd87246454cf78a55062bc666" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BaseSSLProtocol::~BaseSSLProtocol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00035">35</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                  {
        <span class="keywordflow">if</span> (<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a> != NULL) {
                SSL_free(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>);
                <a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a> = NULL;
        }
        <span class="keyword">delete</span>[] <a class="code" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">_pReadBuffer</a>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aad56fbe2f11c703de147dc195affdb3d"></a><!-- doxytag: member="BaseSSLProtocol::AllowFarProtocol" ref="aad56fbe2f11c703de147dc195affdb3d" args="(uint64_t type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::AllowFarProtocol </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Should return true if this protocol can be linked with a far protocol of type 'type'. Otherwise should return false. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>This function must be implemented by the class that inherits this class </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classBaseProtocol.html#ac8f4660dd182affd9af1e927f3f28ed0">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00083">83</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {
        <span class="keywordflow">if</span> (type == <a class="code" href="protocoltypes_8h.html#abaf088acdb021370d9ac31881d590450">PT_TCP</a>)
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a027f1e45adbc701d82c87238b6434300"></a><!-- doxytag: member="BaseSSLProtocol::AllowNearProtocol" ref="a027f1e45adbc701d82c87238b6434300" args="(uint64_t type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::AllowNearProtocol </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Should return true if this protocol can be linked with a near protocol of type 'type'. Otherwise should return false. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>This function must be implemented by the class that inherits this class </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classBaseProtocol.html#a3ef7799202d7ec6d92f68dc3d844762e">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00089">89</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                     {
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a831760013013d1ba62b4570dad7875d5"></a><!-- doxytag: member="BaseSSLProtocol::DoHandshake" ref="a831760013013d1ba62b4570dad7875d5" args="()=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool BaseSSLProtocol::DoHandshake </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="classInboundSSLProtocol.html#a2e13c24c8db5ed4e9359adf6b439d4b8">InboundSSLProtocol</a>, and <a class="el" href="classOutboundSSLProtocol.html#a128967442dc781c186f32c4bc45a8d45">OutboundSSLProtocol</a>.</p>

</div>
</div>
<a class="anchor" id="a9ddd63b95af3ae7177aa015c5dbfafb9"></a><!-- doxytag: member="BaseSSLProtocol::DumpBIO" ref="a9ddd63b95af3ae7177aa015c5dbfafb9" args="(BIO *pBIO)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string BaseSSLProtocol::DumpBIO </td>
          <td>(</td>
          <td class="paramtype">BIO *&#160;</td>
          <td class="paramname"><em>pBIO</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00212">212</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                         {
        <span class="keywordtype">string</span> formatString;
        formatString = <span class="stringliteral">&quot;method: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;callback: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;cb_arg: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;init: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;shutdown: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;flags: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;retry_reason: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;num: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;ptr: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;next_bio: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;prev_bio: %p\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;references: %d\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;num_read: %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>;
        formatString += <span class="stringliteral">&quot;num_write: %&quot;</span>PRId64;
        <span class="keywordflow">return</span> format(formatString,
                        pBIO-&gt;method,
                        pBIO-&gt;callback,
                        pBIO-&gt;cb_arg,
                        pBIO-&gt;init,
                        pBIO-&gt;shutdown,
                        pBIO-&gt;flags,
                        pBIO-&gt;retry_reason,
                        pBIO-&gt;num,
                        pBIO-&gt;ptr,
                        pBIO-&gt;next_bio,
                        pBIO-&gt;prev_bio,
                        pBIO-&gt;references,
                        (int64_t) pBIO-&gt;num_read,
                        (int64_t) pBIO-&gt;num_write);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6d8017db40ae600cb76ca2543a4089fc"></a><!-- doxytag: member="BaseSSLProtocol::EnqueueForOutbound" ref="a6d8017db40ae600cb76ca2543a4089fc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::EnqueueForOutbound </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function can be called by anyone who wants to signal the transport layer that there is data ready to be sent. pExtraParameters usually is a pointer to an OutboundBuffer, but this depends on the protocol type. </p>

<p>Reimplemented from <a class="el" href="classBaseProtocol.html#ab1b51078bd49f84f52116365575b9a7c">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00093">93</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                         {
        <span class="comment">//1. Is the SSL handshake completed?</span>
        <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">_sslHandshakeCompleted</a>) {
                <span class="keywordflow">return</span> <a class="code" href="classBaseSSLProtocol.html#a831760013013d1ba62b4570dad7875d5">DoHandshake</a>();
        }

        <span class="comment">//2. Do we have some outstanding data?</span>
        <a class="code" href="classIOBuffer.html" title="Base class which contains all the necessary functions involving input/output buffering.">IOBuffer</a> *pBuffer = <a class="code" href="classBaseProtocol.html#a7b0f0298b29d7d225ab67768868dac46">_pNearProtocol</a>-&gt;<a class="code" href="classBaseProtocol.html#a048ca4e39ee05ffb339e14637403b744" title="Gets the output buffers.">GetOutputBuffer</a>();
        <span class="keywordflow">if</span> (pBuffer == NULL)
                <span class="keywordflow">return</span> <span class="keyword">true</span>;

        <span class="comment">//3. Encrypt the outstanding data</span>
        <span class="keywordflow">if</span> (SSL_write(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>, <a class="code" href="iobuffer_8h.html#aed6fd97222265185cb7d8fce70eaccd4">GETIBPOINTER</a>(*pBuffer), <a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(*pBuffer))
                        != (int32_t) <a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(*pBuffer)) {
                <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to write %u bytes&quot;</span>, <a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(*pBuffer));
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        pBuffer-&gt;<a class="code" href="classIOBuffer.html#ac254264ebab5b285879865dbed41df07" title="Ignores all data in the buffer.">IgnoreAll</a>();

        <span class="comment">//4. Do the actual I/O</span>
        <span class="keywordflow">return</span> <a class="code" href="classBaseSSLProtocol.html#afca7e0d2aaf118c186f3b2c8e4af8862">PerformIO</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a04941dd84058faa6325dadeea47312ef"></a><!-- doxytag: member="BaseSSLProtocol::GetInputBuffer" ref="a04941dd84058faa6325dadeea47312ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIOBuffer.html">IOBuffer</a> * BaseSSLProtocol::GetInputBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the input buffers. </p>

<p>Reimplemented from <a class="el" href="classBaseProtocol.html#ab3d1ffe0d574c9050e2fd9d622732190">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00122">122</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                           {
        <span class="keywordflow">return</span> &amp;<a class="code" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">_inputBuffer</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a544bdf17ea74226698d3523d4719fee8"></a><!-- doxytag: member="BaseSSLProtocol::GetOutputBuffer" ref="a544bdf17ea74226698d3523d4719fee8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIOBuffer.html">IOBuffer</a> * BaseSSLProtocol::GetOutputBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the output buffers. </p>

<p>Reimplemented from <a class="el" href="classBaseProtocol.html#a048ca4e39ee05ffb339e14637403b744">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00116">116</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
        <span class="keywordflow">if</span> (<a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(<a class="code" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">_outputBuffer</a>) &gt; 0)
                <span class="keywordflow">return</span> &amp;<a class="code" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">_outputBuffer</a>;
        <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acadebf65ef31202b9edee0a4a2992571"></a><!-- doxytag: member="BaseSSLProtocol::GetSSLErrors" ref="acadebf65ef31202b9edee0a4a2992571" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string BaseSSLProtocol::GetSSLErrors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00198">198</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
        <span class="keywordtype">string</span> result = <span class="stringliteral">&quot;&quot;</span>;
        uint32_t errorCode;
        <span class="keywordtype">char</span> *pTempBuffer = <span class="keyword">new</span> <span class="keywordtype">char</span>[4096];
        <span class="keywordflow">while</span> ((errorCode = ERR_get_error()) != 0) {
                memset(pTempBuffer, 0, 4096);
                ERR_error_string_n(errorCode, pTempBuffer, 4095);
                result += <span class="stringliteral">&quot;\n&quot;</span>;
                result += pTempBuffer;
        }
        <span class="keyword">delete</span>[] pTempBuffer;
        <span class="keywordflow">return</span> result;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a026c48144d22744aa3b91f01eb75da19"></a><!-- doxytag: member="BaseSSLProtocol::InitGlobalContext" ref="a026c48144d22744aa3b91f01eb75da19" args="(Variant &amp;parameters)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool BaseSSLProtocol::InitGlobalContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVariant.html">Variant</a> &amp;&#160;</td>
          <td class="paramname"><em>parameters</em></td><td>)</td>
          <td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="classInboundSSLProtocol.html#ad3e16c3c439febeccdcccce60a0c618f">InboundSSLProtocol</a>, and <a class="el" href="classOutboundSSLProtocol.html#a17a3b236a6a3897d54ba1978c47f4e3f">OutboundSSLProtocol</a>.</p>

</div>
</div>
<a class="anchor" id="a44c2cf79a648a548477990b5c2763170"></a><!-- doxytag: member="BaseSSLProtocol::Initialize" ref="a44c2cf79a648a548477990b5c2763170" args="(Variant &amp;parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::Initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVariant.html">Variant</a> &amp;&#160;</td>
          <td class="paramname"><em>parameters</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is called to initialize internal resources specific to each protocol. This is called before adding the protocol to the stack. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">parameters</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseProtocol.html#a8ae54326730a62a6c4a2ea724303b411">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00043">43</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {
        <span class="comment">//1. Initialize the SSL library</span>
        <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#ad5706a8381dffb156cf89ea6d6cbed21">_libraryInitialized</a>) {
                <span class="comment">//3. This is the first time we use the library. So we have to</span>
                <span class="comment">//initialize it first</span>
                SSL_library_init();

                <span class="comment">//init readable error messages</span>
                SSL_load_error_strings();
                ERR_load_SSL_strings();
                ERR_load_CRYPTO_strings();
                ERR_load_crypto_strings();
                OpenSSL_add_all_algorithms();
                OpenSSL_add_all_ciphers();
                OpenSSL_add_all_digests();

                <span class="comment">//initialize the random numbers generator</span>
                <a class="code" href="classBaseSSLProtocol.html#a74e20d241ea004e481c119ae43a26179">InitRandGenerator</a>();
                <a class="code" href="classBaseSSLProtocol.html#ad5706a8381dffb156cf89ea6d6cbed21">_libraryInitialized</a> = <span class="keyword">false</span>;
        }

        <span class="comment">//2. Initialize the global context</span>
        <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#a026c48144d22744aa3b91f01eb75da19">InitGlobalContext</a>(parameters)) {
                <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to initialize global context&quot;</span>);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <span class="comment">//3. create connection SSL context</span>
        <a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a> = SSL_new(<a class="code" href="classBaseSSLProtocol.html#a14fe4edf0aeca0ab3a171797c615aa9f">_pGlobalSSLContext</a>);
        <span class="keywordflow">if</span> (<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a> == NULL) {
                <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to create SSL connection context&quot;</span>);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <span class="comment">//4. setup the I/O buffers</span>
        SSL_set_bio(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>, BIO_new(BIO_s_mem()), BIO_new(BIO_s_mem()));

        <span class="keywordflow">return</span> <a class="code" href="classBaseSSLProtocol.html#a831760013013d1ba62b4570dad7875d5">DoHandshake</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a74e20d241ea004e481c119ae43a26179"></a><!-- doxytag: member="BaseSSLProtocol::InitRandGenerator" ref="a74e20d241ea004e481c119ae43a26179" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseSSLProtocol::InitRandGenerator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00245">245</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                        {
        uint32_t length = 16;
        uint32_t *pBuffer = <span class="keyword">new</span> uint32_t[length];

        <span class="keywordflow">while</span> (RAND_status() == 0) {
                <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; length; i++) {
                        pBuffer[i] = rand();
                }

                RAND_seed(pBuffer, length * 4);
        }

        <span class="keyword">delete</span>[] pBuffer;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afca7e0d2aaf118c186f3b2c8e4af8862"></a><!-- doxytag: member="BaseSSLProtocol::PerformIO" ref="afca7e0d2aaf118c186f3b2c8e4af8862" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::PerformIO </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00180">180</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                {
        <span class="comment">//1. Put the data from SSL output buffer inside our protocol output buffer</span>
        <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">_outputBuffer</a>.<a class="code" href="classIOBuffer.html#afa473a19c659e7f5ff5f21621c64699d" title="Read data from a memory BIO.">ReadFromBIO</a>(SSL_get_wbio(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>))) {
                <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to transfer data from outBIO to outputBuffer&quot;</span>);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <span class="comment">//2. Enqueue the protocol for outbound if we have data that needs to be sent</span>
        <span class="keywordflow">if</span> (<a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(<a class="code" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">_outputBuffer</a>) &gt; 0) {
                <span class="keywordflow">if</span> (<a class="code" href="classBaseProtocol.html#a2b59681d3235fd1101ff6bc74a818e35">_pFarProtocol</a> != NULL) {
                        <span class="keywordflow">return</span> <a class="code" href="classBaseProtocol.html#a2b59681d3235fd1101ff6bc74a818e35">_pFarProtocol</a>-&gt;<a class="code" href="classBaseProtocol.html#ab1b51078bd49f84f52116365575b9a7c" title="This function can be called by anyone who wants to signal the transport layer that there is data read...">EnqueueForOutbound</a>();
                }
        }

        <span class="comment">//3. Done</span>
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a714838df530226551ff8808a6104061c"></a><!-- doxytag: member="BaseSSLProtocol::SignalInputData" ref="a714838df530226551ff8808a6104061c" args="(int32_t recvAmount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::SignalInputData </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>recvAmount</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is called by the framework when data is available for processing, directly from the network i/o layer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">recvAmount</td><td>This function must be implemented by the class that inherits this class </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classBaseProtocol.html#a63edd5c1b1c75b12d3f541bed4c3acef">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00126">126</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {
        <a class="code" href="logging_8h.html#a821326052e3e2bf1fb2d678e9e9a6004">ASSERT</a>(<span class="stringliteral">&quot;OPERATION NOT SUPPORTED&quot;</span>);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1440edc3c12e1d002ef2a0ac86594902"></a><!-- doxytag: member="BaseSSLProtocol::SignalInputData" ref="a1440edc3c12e1d002ef2a0ac86594902" args="(IOBuffer &amp;buffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseSSLProtocol::SignalInputData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIOBuffer.html">IOBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is called by the framework when data is available for processing, from the underlaying protocol (NOT i/o layer) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>This function must be implemented by the class that inherits this class </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classBaseProtocol.html#ad953b0d7b067f65c0cb4c29d1848edbf">BaseProtocol</a>.</p>

<p>Definition at line <a class="el" href="basesslprotocol_8cpp_source.html#l00131">131</a> of file <a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                      {
        <span class="comment">//1. get the SSL input buffer</span>
        BIO *pInBio = SSL_get_rbio(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>);

        <span class="comment">//2. dump all the data from the network inside the ssl input</span>
        BIO_write(pInBio, <a class="code" href="iobuffer_8h.html#aed6fd97222265185cb7d8fce70eaccd4">GETIBPOINTER</a>(buffer),
                        <a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(buffer));
        buffer.<a class="code" href="classIOBuffer.html#ac254264ebab5b285879865dbed41df07" title="Ignores all data in the buffer.">IgnoreAll</a>();

        <span class="comment">//3. Do we have to do some handshake?</span>
        <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">_sslHandshakeCompleted</a>) {
                <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#a831760013013d1ba62b4570dad7875d5">DoHandshake</a>()) {
                        <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to do the SSL handshake&quot;</span>);
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                <span class="keywordflow">if</span> (!<a class="code" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">_sslHandshakeCompleted</a>) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
        }

        <span class="comment">//4. Read the actual data an put it in the descrypted input buffer</span>
        int32_t read = 0;
        <span class="keywordflow">while</span> ((read = SSL_read(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>, <a class="code" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">_pReadBuffer</a>, <a class="code" href="basesslprotocol_8cpp.html#aa29055ce7ec81921b6b8e0446f739973">MAX_SSL_READ_BUFFER</a>)) &gt; 0) {
                <a class="code" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">_inputBuffer</a>.<a class="code" href="classIOBuffer.html#ada6ddd53a2959c54d2d621dfa3f11849" title="Read data from buffer and copy it.">ReadFromBuffer</a>(<a class="code" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">_pReadBuffer</a>, (uint32_t) read);
        }
        <span class="keywordflow">if</span> (read &lt; 0) {
                int32_t error = SSL_get_error(<a class="code" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">_pSSL</a>, read);
                <span class="keywordflow">if</span> (error != SSL_ERROR_WANT_READ &amp;&amp;
                                error != SSL_ERROR_WANT_WRITE) {
                        <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to read data: %d&quot;</span>, error);
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
        }

        <span class="comment">//6. If we have pending data inside the decrypted buffer, bubble it up on the protocol stack</span>
        <span class="keywordflow">if</span> (<a class="code" href="iobuffer_8h.html#a23d30f9ed61d45104297ac1288875dd5">GETAVAILABLEBYTESCOUNT</a>(<a class="code" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">_inputBuffer</a>) &gt; 0) {
                <span class="keywordflow">if</span> (<a class="code" href="classBaseProtocol.html#a7b0f0298b29d7d225ab67768868dac46">_pNearProtocol</a> != NULL) {
                        <span class="keywordflow">if</span> (!<a class="code" href="classBaseProtocol.html#a7b0f0298b29d7d225ab67768868dac46">_pNearProtocol</a>-&gt;<a class="code" href="classBaseProtocol.html#aae1d6f59a1b49b430595acf340967d63" title="This is called by the framework when data is available for processing, when making use of connection-...">SignalInputData</a>(<a class="code" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">_inputBuffer</a>)) {
                                <a class="code" href="logging_8h.html#a0d093cb749cfc7ab5993726392df681f">FATAL</a>(<span class="stringliteral">&quot;Unable to signal near protocol for new data&quot;</span>);
                                <span class="keywordflow">return</span> <span class="keyword">false</span>;
                        }
                }
        }

        <span class="comment">//7. After the data was sent on the upper layers, we might have outstanding</span>
        <span class="comment">//data that needs to be sent.</span>
        <span class="keywordflow">return</span> <a class="code" href="classBaseSSLProtocol.html#afca7e0d2aaf118c186f3b2c8e4af8862">PerformIO</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ab230db51f9ecadd80049354be5a0cdd5"></a><!-- doxytag: member="BaseSSLProtocol::_inputBuffer" ref="ab230db51f9ecadd80049354be5a0cdd5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIOBuffer.html">IOBuffer</a> <a class="el" href="classBaseSSLProtocol.html#ab230db51f9ecadd80049354be5a0cdd5">BaseSSLProtocol::_inputBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00029">29</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad5706a8381dffb156cf89ea6d6cbed21"></a><!-- doxytag: member="BaseSSLProtocol::_libraryInitialized" ref="ad5706a8381dffb156cf89ea6d6cbed21" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classBaseSSLProtocol.html#ad5706a8381dffb156cf89ea6d6cbed21">BaseSSLProtocol::_libraryInitialized</a> = false<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00033">33</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="a22481599b43a13e4204f1fbf7ff2c5f4"></a><!-- doxytag: member="BaseSSLProtocol::_outputBuffer" ref="a22481599b43a13e4204f1fbf7ff2c5f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIOBuffer.html">IOBuffer</a> <a class="el" href="classBaseSSLProtocol.html#a22481599b43a13e4204f1fbf7ff2c5f4">BaseSSLProtocol::_outputBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00030">30</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="adf9da7f6c4000a46f7a73f9a73f374ea"></a><!-- doxytag: member="BaseSSLProtocol::_pGlobalContexts" ref="adf9da7f6c4000a46f7a73f9a73f374ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt; string, SSL_CTX * &gt; <a class="el" href="classBaseSSLProtocol.html#adf9da7f6c4000a46f7a73f9a73f374ea">BaseSSLProtocol::_pGlobalContexts</a><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00032">32</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="a14fe4edf0aeca0ab3a171797c615aa9f"></a><!-- doxytag: member="BaseSSLProtocol::_pGlobalSSLContext" ref="a14fe4edf0aeca0ab3a171797c615aa9f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SSL_CTX* <a class="el" href="classBaseSSLProtocol.html#a14fe4edf0aeca0ab3a171797c615aa9f">BaseSSLProtocol::_pGlobalSSLContext</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00034">34</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8ae80d46938d12b04df47f03780e1ab1"></a><!-- doxytag: member="BaseSSLProtocol::_pReadBuffer" ref="a8ae80d46938d12b04df47f03780e1ab1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* <a class="el" href="classBaseSSLProtocol.html#a8ae80d46938d12b04df47f03780e1ab1">BaseSSLProtocol::_pReadBuffer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00037">37</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="a96e22b2ea80a706db4bcf93450358076"></a><!-- doxytag: member="BaseSSLProtocol::_pSSL" ref="a96e22b2ea80a706db4bcf93450358076" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SSL* <a class="el" href="classBaseSSLProtocol.html#a96e22b2ea80a706db4bcf93450358076">BaseSSLProtocol::_pSSL</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00035">35</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa02fffbcbc3e37530ff12d674f411a41"></a><!-- doxytag: member="BaseSSLProtocol::_sslHandshakeCompleted" ref="aa02fffbcbc3e37530ff12d674f411a41" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classBaseSSLProtocol.html#aa02fffbcbc3e37530ff12d674f411a41">BaseSSLProtocol::_sslHandshakeCompleted</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="basesslprotocol_8h_source.html#l00036">36</a> of file <a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>branches/1.0/sources/thelib/include/protocols/ssl/<a class="el" href="basesslprotocol_8h_source.html">basesslprotocol.h</a></li>
<li>branches/1.0/sources/thelib/src/protocols/ssl/<a class="el" href="basesslprotocol_8cpp_source.html">basesslprotocol.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Oct 19 2011 15:53:37 for crtmpserver by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
